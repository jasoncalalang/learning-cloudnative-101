(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{"013z":function(e,t,a){"use strict";var i=a("q1tI"),n=a.n(i),r=a("NmYn"),o=a.n(r),l=a("Wbzz"),c=a("Xrax"),s=a("k4MR"),b=a("TSYQ"),p=a.n(b),m=a("QH2O"),u=a("qKvR"),d=function(e){var t,a=e.title,i=e.tabs,n=void 0===i?[]:i;return Object(u.b)("div",{className:p()(m.pageHeader,(t={},t[m.withTabs]=n.length,t))},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12"},Object(u.b)("h1",{id:"page-title",className:m.text},a)))))},g=a("BAC9"),h=function(e){var t=e.relativePagePath,a=e.repository,i=Object(l.useStaticQuery)("1364590287").site.siteMetadata.repository,n=a||i,r=n.baseUrl,o=n.subDirectory,c=r+"/edit/"+n.branch+o+"/src/pages"+t;return r?Object(u.b)("div",{className:"bx--row "+g.row},Object(u.b)("div",{className:"bx--col"},Object(u.b)("a",{className:g.link,href:c},"Edit this page on GitHub"))):null},O=a("FCXl"),j=a("dI71"),f=a("I8xM"),N=function(e){function t(){return e.apply(this,arguments)||this}return Object(j.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.tabs,a=e.slug,i=a.split("/").filter(Boolean).slice(-1)[0],n=t.map((function(e){var t,n=o()(e,{lower:!0,strict:!0}),r=n===i,c=new RegExp(i+"/?(#.*)?$"),s=a.replace(c,n);return Object(u.b)("li",{key:e,className:p()((t={},t[f.selectedItem]=r,t),f.listItem)},Object(u.b)(l.Link,{className:f.link,to:""+s},e))}));return Object(u.b)("div",{className:f.tabsContainer},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(u.b)("nav",null,Object(u.b)("ul",{className:f.list},n))))))},t}(n.a.Component),y=a("MjG9");t.a=function(e){var t=e.pageContext,a=e.children,i=e.location,n=e.Title,r=t.frontmatter,b=void 0===r?{}:r,p=t.relativePagePath,m=t.titleType,g=b.tabs,j=b.title,f=b.theme,x=b.description,w=b.keywords,v=Object(l.useStaticQuery)("2456312558").site.pathPrefix,k=v?i.pathname.replace(v,""):i.pathname,T=g?k.split("/").filter(Boolean).slice(-1)[0]||o()(g[0],{lower:!0}):"";return Object(u.b)(s.a,{tabs:g,homepage:!1,theme:f,pageTitle:j,pageDescription:x,pageKeywords:w,titleType:m},Object(u.b)(d,{title:n?Object(u.b)(n,null):j,label:"label",tabs:g}),g&&Object(u.b)(N,{slug:k,tabs:g,currentTab:T}),Object(u.b)(y.a,{padded:!0},a,Object(u.b)(h,{relativePagePath:p})),Object(u.b)(O.a,{pageContext:t,location:i,slug:k,tabs:g,currentTab:T}),Object(u.b)(c.a,null))}},"2yob":function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return l})),a.d(t,"default",(function(){return b}));var i=a("wx14"),n=a("zLVn"),r=(a("q1tI"),a("7ljp")),o=a("013z"),l=(a("qKvR"),{}),c={_frontmatter:l},s=o.a;function b(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(r.b)(s,Object(i.a)({},c,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",null,"Challenge"),Object(r.b)("p",null,"You are provided with the challenge to implement a demo that shows best practices for DevOps.\nImplement Continous Integration and Continous Deployment for an Application on Kubernetes."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Git repository with application code and Dockerfile, Developers have access to this git repository"),Object(r.b)("li",{parentName:"ul"},"Git repository with pipeline manifest files (ie yamls) files, Operators have access to this repository"),Object(r.b)("li",{parentName:"ul"},"Git repository with application manifest (ie yaml) files, automation only have access to this repository")),Object(r.b)("h2",null,"Specifications"),Object(r.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"818px"}},"\n      ",Object(r.b)("span",Object(i.a)({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"31.59722222222222%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAABLElEQVQY011RS07DMBDNZTkCN+AOHIItYgEbFlUlyKJsWBQqmqRq/g12fo5/eYzdn8RIT54ZzxvPPAdwNltIKWGNwUwhLw8oNjEsRS6nlPKnL51nnG0mnr2EFkYbBExb9ARNJCEmKK1QpRWi9Q7aaP+QIggqbtSR7eqstVRLYCt8RjneFjuIMERwlxg85ERqGapDjbIoIKYJbdeCc440y2HHHq95h9sfjW4UiMMl6v0O/TSjWd0gi55BVKh0j2C5TbEpGxglwdsOv4z7qdwU4ziiHwbISSBjLRZR5ieMv9foOKMNDJJkC9bUfuWeBgn0OECR4+wplLh/bMkz0LSiMSfQeq6pcE209o3Od1IqOq2XwCHw4p5k/fjieHnPjxKT2u4Dzrh+xP/89c7ZHxOmzVvIViJ9AAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(r.b)("img",Object(i.a)({parentName:"span"},{className:"gatsby-resp-image-image",alt:"overview-diagram",title:"overview-diagram",src:"/static/e0f59cda603cd30cfc3a5138da9d879c/96d67/tekton-argocd.png",srcSet:["/static/e0f59cda603cd30cfc3a5138da9d879c/7fc1e/tekton-argocd.png 288w","/static/e0f59cda603cd30cfc3a5138da9d879c/a5df1/tekton-argocd.png 576w","/static/e0f59cda603cd30cfc3a5138da9d879c/96d67/tekton-argocd.png 818w"],sizes:"(max-width: 818px) 100vw, 818px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),Object(r.b)("h3",null,"Code Git Repository"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code"}),"Git repository with application code")),Object(r.b)("li",{parentName:"ul"},"Create a new git repository using this repo as ",Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-code/generate"}),"template")),Object(r.b)("li",{parentName:"ul"},"Use the ",Object(r.b)("inlineCode",{parentName:"li"},"Dockerfile")," on the root of the repository to build a container image")),Object(r.b)("h3",null,"Infra Git Repository"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra"}),"Git repository with application manifest")),Object(r.b)("li",{parentName:"ul"},"Create a new git repository using this repo as ",Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"https://github.com/ibm-cloud-architecture/tutorial-tekton-argocd-infra/generate"}),"template")),Object(r.b)("li",{parentName:"ul"},"The directory ",Object(r.b)("inlineCode",{parentName:"li"},"ocp/yamls")," contains the application manifest files")),Object(r.b)("h3",null,"Pipeline Git Repository"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Create new repository to store pipeline resources"),Object(r.b)("li",{parentName:"ul"},"Use the ServiceAccount ",Object(r.b)("inlineCode",{parentName:"li"},"pipeline")),Object(r.b)("li",{parentName:"ul"},"Use the following guide to create a Pipeline, Tasks, and secret:",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Create a pipeline, tasks, secrets on the target namespace"),Object(r.b)("li",{parentName:"ul"},"Git clone the source code from the App repo"),Object(r.b)("li",{parentName:"ul"},"Build a container image using the ",Object(r.b)("inlineCode",{parentName:"li"},"Dockerfile")," on the repo"),Object(r.b)("li",{parentName:"ul"},"Tag the image using the 7 first characters of the git hash corresponding to last git commit"),Object(r.b)("li",{parentName:"ul"},"Push the container image into the internal image registry on the same namespace"),Object(r.b)("li",{parentName:"ul"},"Git clone the Infra git repo"),Object(r.b)("li",{parentName:"ul"},"Update the image on the deployment yaml with the new image id that has the tag with value of the git commit"),Object(r.b)("li",{parentName:"ul"},"Git commit the changes"),Object(r.b)("li",{parentName:"ul"},"Git push the changes to the infra git repo, this should trigger argocd to pickup any changes from the infra repo.")))),Object(r.b)("h2",null,"Hints"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"The secret contains the git username and token with permission ",Object(r.b)("inlineCode",{parentName:"li"},"repo")," that gives write access to the git infra repository"),Object(r.b)("li",{parentName:"ul"},"OpenShift 4 comes with an internal image registry you can push from a Tekton task"),Object(r.b)("li",{parentName:"ul"},"The image registry url contains the service name, port, namespace, image name and tag",Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"image-registry.openshift-image-registry.svc:5000/my-namespace-app/image-name:my-tag\n"))),Object(r.b)("li",{parentName:"ul"},"The image registry only handles ssl/https connections, but it uses a self sign certificate"),Object(r.b)("li",{parentName:"ul"},"You need to ignore TLS-Verify to be able to succesfully push and ignore ssl errors for example using buildah set the flag ",Object(r.b)("inlineCode",{parentName:"li"},'--tls-verify="false"'))),Object(r.b)("h2",null,"Extra Credit"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Make the pipeline to run automatically every time new code gets pushed to the Code git repository",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Configure a Github Webhook using the new ",Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"https://github.com/tektoncd/triggers"}),"Tekton Triggers")," listener and bindings")))),Object(r.b)("h2",null,"Solution"),Object(r.b)("p",null,"Here is one implementation as a ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"./solution"}),"solution")))}b.isMDXComponent=!0},BAC9:function(e,t,a){e.exports={bxTextTruncateEnd:"EditLink-module--bx--text-truncate--end--2pqje",bxTextTruncateFront:"EditLink-module--bx--text-truncate--front--3_lIE",link:"EditLink-module--link--1qzW3",row:"EditLink-module--row--1B9Gk"}},I8xM:function(e,t,a){e.exports={bxTextTruncateEnd:"PageTabs-module--bx--text-truncate--end--267NA",bxTextTruncateFront:"PageTabs-module--bx--text-truncate--front--3xEQF",tabsContainer:"PageTabs-module--tabs-container--8N4k0",list:"PageTabs-module--list--3eFQc",listItem:"PageTabs-module--list-item--nUmtD",link:"PageTabs-module--link--1mDJ1",selectedItem:"PageTabs-module--selected-item--YPVr3"}},QH2O:function(e,t,a){e.exports={bxTextTruncateEnd:"PageHeader-module--bx--text-truncate--end--mZWeX",bxTextTruncateFront:"PageHeader-module--bx--text-truncate--front--3zvrI",pageHeader:"PageHeader-module--page-header--3hIan",withTabs:"PageHeader-module--with-tabs--3nKxA",text:"PageHeader-module--text--o9LFq"}}}]);
//# sourceMappingURL=component---src-pages-projects-project-cicd-index-mdx-ef4391b414fd57a548b5.js.map